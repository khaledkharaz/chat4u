/* Import a professional font */
/* Added in index.html head:
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
*/

/* CSS Variables for a Professional Palette - Version 3 */
:root {
    /* Core Colors */
    --primary-brand: #007BFF; /* A standard, clear blue */
    --primary-darker: #0056b3; /* Darker shade for hover */
    --accent-action: #28A745; /* A success green for positive actions like send */
    --accent-action-darker: #218838; /* Darker green for hover */

    /* Grayscale & Surface */
    --background: #F8F9FA; /* Very light background */
    --surface: #FFFFFF; /* White for containers/cards */
    --text-primary: #212529; /* Dark text */
    --text-secondary: #6C757D; /* Muted text */
    --text-placeholder: #ADB5BD; /* Placeholder text color */
    --border-light: #DEE2E6; /* Light border */
    --border-medium: #CED4DA; /* Medium border */
    --disabled-bg: #E9ECEF; /* Light disabled background */
    --disabled-text: #ADB5BD; /* Light disabled text */

    /* Element Backgrounds */
    --input-bg: #FFFFFF; /* White input background */
    --bot-message-bg: #E9ECEF; /* Light grey bot message background */
    --user-message-bg: var(--primary-brand); /* User messages use primary brand color */
    --button-text-light: #FFFFFF; /* White text on colored buttons */
}

/* Dark Mode Variables - Version 3 */
body.dark-mode {
    /* Core Colors */
    --primary-brand: #007BFF; /* Primary stays the same */
    --primary-darker: #0056b3; /* Primary hover stays the same */
    --accent-action: #28A745; /* Accent stays the same for clarity */
    --accent-action-darker: #218838; /* Accent hover stays the same */


    /* Grayscale & Surface */
    --background: #212529; /* Dark background */
    --surface: #343A40; /* Dark grey for containers */
    --text-primary: #F8F9FA; /* Lightest text */
    --text-secondary: #CED4DA; /* Medium light text */
    --text-placeholder: #ADB5BD; /* Placeholder text color */
    --border-light: #495057; /* Dark border */
    --border-medium: #6C757D; /* Medium dark border */
    --disabled-bg: #495057; /* Dark disabled background */
    --disabled-text: #6C757D; /* Dark disabled text */

    /* Element Backgrounds */
    --input-bg: #343A40; /* Dark input background */
    --bot-message-bg: #495057; /* Dark grey bot message background */
    --user-message-bg: var(--primary-brand); /* User messages still use primary brand color */
    --button-text-light: #FFFFFF; /* Text on primary/accent buttons remains white for contrast */
}


body {
    font-family: 'Roboto', sans-serif;
    display: flex;
    flex-direction: column;
    justify-content: flex-start; /* Align items from the start */
    align-items: center;
    min-height: 100vh;
    background-color: var(--background);
    color: var(--text-primary);
    margin: 0;
    padding: 20px;
    box-sizing: border-box;
    transition: background-color 0.3s ease, color 0.3s ease;
    line-height: 1.6;
}

/* Style for the mode toggle button */
.mode-toggle {
    /* Position it absolutely for more precise placement */
    position: absolute;
    top: 20px;
    right: 20px;

    padding: 8px; /* Icon button style */
    background-color: transparent; /* No background */
    color: var(--text-secondary); /* Use secondary text color for icon */
    border: 1px solid var(--border-light); /* Subtle border */
    border-radius: 5px; /* Slight roundness */
    cursor: pointer;
    font-size: 0.9em; /* Smaller font if text fallback */
    font-weight: 500;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
    display: flex; /* Align icon */
    align-items: center;
    justify-content: center;
    width: 36px; /* Fixed size */
    height: 36px;
}

.mode-toggle .mode-icon {
    width: 20px;
    height: 20px;
}

.mode-toggle:hover:not(:disabled) {
    background-color: rgba(0, 0, 0, 0.05); /* Subtle hover background */
    border-color: var(--border-medium); /* Slightly darker border on hover */
}
body.dark-mode .mode-toggle:hover:not(:disabled) {
    background-color: rgba(255, 255, 255, 0.1); /* Subtle hover background */
}


.container {
    background-color: var(--surface);
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    width: 100%;
    max-width: 650px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    min-height: 80vh;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    border: 1px solid var(--border-light);
    margin-top: 60px; /* Space from the top to avoid toggle button */
}

body.dark-mode .container {
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
}


#persona-selection {
    padding: 40px;
    text-align: center;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

#persona-selection h2 {
    color: var(--text-primary);
    margin-bottom: 30px;
    font-size: 1.8em;
    font-weight: 700;
    transition: color 0.3s ease;
}

#persona-select {
    padding: 12px;
    margin-bottom: 25px;
    border: 1px solid var(--border-medium);
    border-radius: 8px;
    font-size: 1.1em;
    width: 100%;
    max-width: 350px;
    box-sizing: border-box;
    background-color: var(--input-bg);
    color: var(--text-primary);
    appearance: none;
    /* Custom arrow colors */
    background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%236C757D%22%20d%3D%22M287%2C114.7L159.3%2C242.5c-5.4%2C5.4-11.8%2C8-18.2%2C8s-12.8-2.7-18.2-8L5.4%2C114.7C0.2%2C109.5-1.4%2C102-0.3%2C94.4c1.1-7.6%2C6-13.6%2C12.7-17.3l139.5-80.7c6.4-3.7%2C13.8-3.7%2C20.2%2C0l139.5%2C80.7c6.7%2C3.6%2C11.6%2C9.6%2C12.7%2C17.3C293.4%2C102%2C291.8%2C109.5%2C287%2C114.7z%22%2F%3E%3C%2Fsvg%3E');
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 14px auto;
    padding-right: 35px;
    cursor: pointer;
    transition: border-color 0.2s ease, background-color 0.2s ease, color 0.2s ease;
}
body.dark-mode #persona-select {
     background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23CED4DA%22%20d%3D%22M287%2C114.7L159.3%2C242.5c-5.4%2C5.4-11.8%2C8-18.2%2C8s-12.8-2.7-18.2-8L5.4%2C114.7C0.2%2C109.5-1.4%2C102-0.3%2C94.4c1.1-7.6%2C6-13.6%2C12.7-17.3l139.5-80.7c6.4-3.7%2C13.8-3.7%2C20.2%2C0l139.5%2C80.7c6.7%2C3.6%2C11.6%2C9.6%2C12.7%2C17.3C293.4%2C102%2C291.8%2C109.5%2C287%2C114.7z%22%2F%3E%3C%2Fsvg%3E');
}


#start-chat-button {
    padding: 14px 30px;
    background-color: var(--primary-brand); /* Primary button */
    color: var(--button-text-light);
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1.2em;
    font-weight: 500;
    transition: background-color 0.2s ease, opacity 0.2s ease;
}

#start-chat-button:hover:not(:disabled) {
    background-color: var(--primary-darker); /* Darker primary on hover */
    opacity: 1;
}

#start-chat-button:disabled {
    background-color: var(--disabled-bg);
    color: var(--disabled-text);
    cursor: not-allowed;
    opacity: 1;
}

#chat-container {
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    height: 100%;
}

#chat-header {
    padding: 15px 20px;
    background-color: var(--surface);
    border-bottom: 1px solid var(--border-light);
    font-weight: 700;
    color: var(--text-primary);
    text-align: center;
    transition: background-color 0.3s ease, border-bottom-color 0.3s ease, color 0.3s ease;
    font-size: 1.1em;
}

#chatbox {
    flex-grow: 1;
    overflow-y: auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
    background-color: var(--surface);
    transition: background-color 0.3s ease;
}

.message {
    margin-bottom: 15px;
    padding: 12px 18px;
    border-radius: 20px;
    max-width: 85%;
    word-wrap: break-word;
    line-height: 1.5;
    font-size: 1em;
}

.user-message {
    align-self: flex-end;
    background-color: var(--user-message-bg);
    color: var(--button-text-light);
    border-bottom-right-radius: 8px;
}

.bot-message {
    align-self: flex-start;
    background-color: var(--bot-message-bg);
    color: var(--text-primary);
    border-bottom-left-radius: 8px;
    transition: background-color 0.3s ease, color 0.3s ease;
}

/* Style for the initial instruction message */
#chatbox .bot-message.initial-message {
    margin-top: auto;
    font-style: italic;
    color: var(--text-secondary);
    background-color: transparent;
    padding: 0;
    margin-bottom: 20px;
    border-radius: 0;
    align-self: center;
    text-align: center;
    font-size: 0.9em;
}


#input-area {
    display: flex;
    padding: 15px 20px;
    border-top: 1px solid var(--border-light);
    background-color: var(--surface);
    gap: 10px;
    transition: background-color 0.3s ease, border-top-color 0.3s ease;
}

#user-input {
    flex-grow: 1;
    padding: 12px 15px;
    border: 1px solid var(--border-medium);
    border-radius: 8px;
    font-size: 1em;
    box-sizing: border-box;
    background-color: var(--input-bg);
    color: var(--text-primary);
    transition: border-color 0.2s ease, background-color 0.2s ease, color 0.2s ease;
}

#user-input::placeholder {
    color: var(--text-placeholder);
    opacity: 1;
}


#send-button {
    padding: 10px 20px;
    background-color: var(--accent-action); /* Use the accent action color (green) for Send */
    color: var(--button-text-light);
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1em;
    font-weight: 500;
    transition: background-color 0.2s ease, opacity 0.2s ease;
}

#send-button:hover:not(:disabled) {
     background-color: var(--accent-action-darker); /* Darker accent on hover */
     opacity: 1;
}
#send-button:disabled {
    background-color: var(--disabled-bg);
    color: var(--disabled-text);
    cursor: not-allowed;
    opacity: 1;
}


/* Utility class for hiding elements */
.hidden {
    display: none !important;
}

/* CSS for Typing Indicator Dots */
@keyframes blink {
  0% { opacity: .2; }
  20% { opacity: 1; }
  100% { opacity: .2; }
}

.message.bot-message.typing {
    background-color: var(--bot-message-bg);
     color: var(--text-primary);
     font-size: 1.2em;
     width: auto;
     padding: 10px 15px;
     border-bottom-left-radius: 8px;
}

.message.bot-message.typing .dot {
  animation: blink 1.4s infinite;
  animation-fill-mode: both;
   color: var(--text-primary);
}

.message.bot-message.typing .dot:nth-child(2) {
  animation-delay: .2s;
}

.message.bot-message.typing .dot:nth-child(3) {
  animation-delay: .4s;
}


/* Responsive adjustments */
@media (max-width: 600px) {
    body {
        padding: 0;
        align-items: stretch;
    }
     .mode-toggle {
         right: 15px;
         top: 15px;
     }
    .container {
        min-height: 100vh;
        border-radius: 0;
         box-shadow: none;
         border: none;
         margin-top: 0; /* Remove top margin on small screens */
    }
    #persona-selection, #chatbox, #input-area {
        padding: 20px 15px;
    }
     #persona-selection h2 {
         font-size: 1.6em;
         margin-bottom: 20px;
     }

     #chatbox {
         padding-bottom: 15px;
     }
     .message {
         max-width: 90%;
     }
}